<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LCF Civic Summaries</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%);
        }
        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        .loading-spinner {
            border: 3px solid #f3f4f6;
            border-top: 3px solid #3b82f6;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <!-- Loading Screen -->
    <div id="loading" class="fixed inset-0 bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center z-50">
        <div class="text-center">
            <div class="loading-spinner mx-auto mb-4"></div>
            <p class="text-lg text-gray-600">Loading government updates...</p>
        </div>
    </div>

    <!-- Main Content -->
    <div id="main-content" class="hidden">
        <!-- Header -->
        <header class="bg-white shadow-lg border-b-4 border-blue-600">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
                <div class="flex flex-col md:flex-row md:items-center md:justify-between">
                    <div class="flex items-center space-x-3 mb-4 md:mb-0">
                        <i class="fas fa-building text-3xl text-blue-600"></i>
                        <div>
                            <h1 class="text-3xl font-bold text-gray-900">LCF Civic Summaries</h1>
                            <p class="text-gray-600">Stay informed about La Cañada Flintridge government activities</p>
                        </div>
                    </div>
                    <div class="flex items-center space-x-4">
                        <span class="text-sm text-gray-500">Last updated: <span id="last-updated">Loading...</span></span>
                        <button onclick="refreshData()" class="flex items-center space-x-1 px-3 py-1 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors">
                            <i class="fas fa-sync-alt"></i>
                            <span>Refresh</span>
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="bg-gray-50 border-b border-gray-200">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex space-x-8 py-4">
                    <a href="/" class="text-blue-600 font-medium border-b-2 border-blue-600 pb-2">Current Summaries</a>
                    <a href="/archive.html" class="text-gray-600 hover:text-blue-600 font-medium pb-2 transition-colors">2025 Archive</a>
                    <a href="https://lcf.ca.gov/city-clerk/agenda-minutes/" target="_blank" class="text-gray-600 hover:text-blue-600 font-medium pb-2 transition-colors">Official Documents</a>
                </div>
            </div>
        </nav>

        <!-- Stats Bar -->
        <div class="gradient-bg text-white">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-center">
                    <div>
                        <div id="total-docs" class="text-2xl font-bold">0</div>
                        <div class="text-blue-100">Total Documents</div>
                    </div>
                    <div>
                        <div id="total-bodies" class="text-2xl font-bold">0</div>
                        <div class="text-blue-100">Government Bodies</div>
                    </div>
                    <div>
                        <div class="text-2xl font-bold">Weekly</div>
                        <div class="text-blue-100">Update Schedule</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Search and Filter -->
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <div class="flex flex-col md:flex-row gap-4">
                    <div class="flex-1">
                        <div class="relative">
                            <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                            <input 
                                type="text" 
                                id="search-input"
                                placeholder="Search meetings, agendas, and summaries..."
                                class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                oninput="filterData()"
                            >
                        </div>
                    </div>
                    <div class="md:w-64">
                        <select 
                            id="body-filter"
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                            onchange="filterData()"
                        >
                            <option value="all">All Government Bodies</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Results -->
            <div id="results-container">
                <!-- Content will be loaded here -->
            </div>

            <!-- No Results -->
            <div id="no-results" class="hidden text-center py-12">
                <i class="fas fa-file-alt text-4xl text-gray-400 mb-4"></i>
                <h3 class="text-lg font-medium text-gray-900 mb-2">No documents found</h3>
                <p class="text-gray-500">Try adjusting your search terms or filters.</p>
            </div>
        </div>

        <!-- Footer -->
        <footer class="bg-gray-800 text-white mt-12">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div>
                        <h3 class="text-lg font-semibold mb-4">About This Site</h3>
                        <p class="text-gray-300 text-sm leading-relaxed">
                            This website automatically tracks and summarizes La Cañada Flintridge government meetings 
                            to keep residents informed about local government activities.
                        </p>
                    </div>
                    <div>
                        <h3 class="text-lg font-semibold mb-4">Government Bodies</h3>
                        <ul id="footer-bodies" class="text-gray-300 text-sm space-y-1">
                            <!-- Will be populated by JavaScript -->
                        </ul>
                    </div>
                    <div>
                        <h3 class="text-lg font-semibold mb-4">Official Resources</h3>
                        <div class="space-y-2">
                            <a 
                                href="https://lcf.ca.gov/city-clerk/agenda-minutes/" 
                                target="_blank" 
                                rel="noopener noreferrer"
                                class="flex items-center text-gray-300 hover:text-white text-sm transition-colors"
                            >
                                <i class="fas fa-external-link-alt mr-2"></i>
                                Official Meeting Documents
                            </a>
                            <a 
                                href="https://lcf.ca.gov/" 
                                target="_blank" 
                                rel="noopener noreferrer"
                                class="flex items-center text-gray-300 hover:text-white text-sm transition-colors"
                            >
                                <i class="fas fa-external-link-alt mr-2"></i>
                                City Website
                            </a>
                        </div>
                    </div>
                </div>
                <div class="border-t border-gray-700 mt-8 pt-8 text-center text-gray-400 text-sm">
                    <p>© 2025 LCF Civic Summaries. Updated weekly with the latest government activities.</p>
                </div>
            </div>
        </footer>
    </div>

    <script>
        let allData = {};
        let filteredData = {};

        // Mock data for demonstration
        const mockData = {
            "City Council": {
                "agendas": [
                    {
                        "title": "City Council Regular Meeting Agenda",
                        "type": "agenda",
                        "date": "2025-07-15T19:00:00",
                        "summary": "The upcoming City Council meeting will address several key items including the annual budget review, proposed traffic calming measures on Foothill Boulevard, and updates on the Community Center renovation project. Public comment period scheduled for 7:30 PM.",
                        "ai_generated": true,
                        "url": "https://lcf.ca.gov/city-clerk/agenda-minutes/"
                    }
                ],
                "minutes": [
                    {
                        "title": "City Council Regular Meeting Minutes",
                        "type": "minutes", 
                        "date": "2025-07-08T19:00:00",
                        "summary": "Council approved the $2.3M budget allocation for street improvements, unanimously passed Resolution 2025-15 regarding noise ordinance updates, and received presentations on the new recycling program. Mayor Johnson announced the upcoming town hall on housing development.",
                        "ai_generated": true,
                        "url": "https://lcf.ca.gov/city-clerk/agenda-minutes/"
                    }
                ]
            },
            "Planning Commission": {
                "agendas": [
                    {
                        "title": "Planning Commission Meeting Agenda",
                        "type": "agenda",
                        "date": "2025-07-14T18:00:00",
                        "summary": "Review of three residential development proposals, discussion of updated zoning guidelines for hillside properties, and consideration of the General Plan Housing Element update. Site visit scheduled for the Oakwood development project.",
                        "ai_generated": true,
                        "url": "https://lcf.ca.gov/city-clerk/agenda-minutes/"
                    }
                ],
                "minutes": [
                    {
                        "title": "Planning Commission Meeting Minutes",
                        "type": "minutes",
                        "date": "2025-07-07T18:00:00",
                        "summary": "Commission approved the conditional use permit for the new medical office building on Foothill Boulevard with conditions regarding parking and landscaping. Denied the variance request for 1234 Oak Street due to setback concerns.",
                        "ai_generated": true,
                        "url": "https://lcf.ca.gov/city-clerk/agenda-minutes/"
                    }
                ]
            },
            "Public Safety Commission": {
                "agendas": [
                    {
                        "title": "Public Safety Commission Agenda",
                        "type": "agenda",
                        "date": "2025-07-13T17:00:00",
                        "summary": "Discussion of emergency preparedness protocols, review of recent fire safety inspections, and presentation on the new neighborhood watch program. Update on traffic enforcement initiatives and pedestrian safety measures.",
                        "ai_generated": false
                    }
                ],
                "minutes": [
                    {
                        "title": "Public Safety Commission Minutes", 
                        "type": "minutes",
                        "date": "2025-07-06T17:00:00",
                        "summary": "Commission reviewed quarterly crime statistics showing a 15% decrease in property crimes. Approved funding for additional emergency communication equipment and discussed coordination with LA County Fire Department for wildfire prevention.",
                        "ai_generated": false
                    }
                ]
            }
        };

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', { 
                weekday: 'long',
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: 'numeric',
                minute: '2-digit'
            });
        }

        function getTotalDocuments(data) {
            return Object.values(data).reduce((total, body) => {
                return total + (body.agendas?.length || 0) + (body.minutes?.length || 0);
            }, 0);
        }

        function updateStats(data) {
            document.getElementById('total-docs').textContent = getTotalDocuments(data);
            document.getElementById('total-bodies').textContent = Object.keys(data).length;
        }

        function populateBodyFilter(data) {
            const select = document.getElementById('body-filter');
            const footerList = document.getElementById('footer-bodies');
            
            // Clear existing options (except "All")
            select.innerHTML = '<option value="all">All Government Bodies</option>';
            footerList.innerHTML = '';
            
            Object.keys(data).forEach(bodyName => {
                const option = document.createElement('option');
                option.value = bodyName;
                option.textContent = bodyName;
                select.appendChild(option);
                
                const li = document.createElement('li');
                li.textContent = `• ${bodyName}`;
                footerList.appendChild(li);
            });
        }

        function filterData() {
            const searchTerm = document.getElementById('search-input').value.toLowerCase();
            const selectedBody = document.getElementById('body-filter').value;
            
            filteredData = {};
            
            Object.keys(allData).forEach(bodyName => {
                if (selectedBody === 'all' || selectedBody === bodyName) {
                    const bodyData = allData[bodyName];
                    const filteredAgendas = bodyData.agendas?.filter(item => 
                        item.title.toLowerCase().includes(searchTerm) ||
                        item.summary.toLowerCase().includes(searchTerm)
                    ) || [];
                    
                    const filteredMinutes = bodyData.minutes?.filter(item =>
                        item.title.toLowerCase().includes(searchTerm) ||
                        item.summary.toLowerCase().includes(searchTerm)
                    ) || [];

                    if (filteredAgendas.length > 0 || filteredMinutes.length > 0) {
                        filteredData[bodyName] = {
                            agendas: filteredAgendas,
                            minutes: filteredMinutes
                        };
                    }
                }
            });
            
            renderResults(filteredData);
        }

        function renderResults(data) {
            const container = document.getElementById('results-container');
            const noResults = document.getElementById('no-results');
            
            if (Object.keys(data).length === 0) {
                container.innerHTML = '';
                noResults.classList.remove('hidden');
                return;
            }
            
            noResults.classList.add('hidden');
            
            let html = '';
            
            Object.entries(data).forEach(([bodyName, bodyData]) => {
                html += `
                    <div class="bg-white rounded-lg shadow-md overflow-hidden mb-8 card-hover">
                        <div class="bg-gray-50 px-6 py-4 border-b">
                            <h2 class="text-xl font-semibold text-gray-900 flex items-center">
                                <i class="fas fa-building mr-2 text-blue-600"></i>
                                ${bodyName}
                            </h2>
                        </div>
                        
                        <div class="p-6">
                            <div class="grid gap-6 md:grid-cols-2">
                `;
                
                // Agendas
                if (bodyData.agendas?.length > 0) {
                    html += `
                        <div>
                            <h3 class="text-lg font-medium text-gray-900 mb-4 flex items-center">
                                <i class="fas fa-calendar mr-2 text-green-600"></i>
                                Upcoming Meetings
                            </h3>
                            <div class="space-y-4">
                    `;
                    
                    bodyData.agendas.forEach(agenda => {
                        html += `
                            <div class="border border-gray-200 rounded-lg p-4 border-l-4 border-l-green-500">
                                <div class="flex items-start justify-between mb-2">
                                    <h4 class="font-medium text-gray-900">${agenda.title}</h4>
                                    <span class="ml-2 px-2 py-1 text-xs rounded-full ${agenda.ai_generated ? 'bg-blue-100 text-blue-800' : 'bg-gray-100 text-gray-800'}">
                                        ${agenda.ai_generated ? 'AI Summary' : 'Auto Summary'}
                                    </span>
                                </div>
                                <p class="text-sm text-gray-600 mb-3 flex items-center">
                                    <i class="fas fa-calendar mr-1"></i>
                                    ${formatDate(agenda.date)}
                                </p>
                                <p class="text-gray-700 leading-relaxed mb-3">${agenda.summary}</p>
                                ${agenda.url ? `
                                    <div class="pt-2 border-t border-gray-100">
                                        <a href="${agenda.url}" target="_blank" rel="noopener noreferrer" 
                                           class="inline-flex items-center text-sm text-blue-600 hover:text-blue-800 transition-colors">
                                            <i class="fas fa-external-link-alt mr-1"></i>
                                            View Full Agenda Document
                                        </a>
                                    </div>
                                ` : ''}
                            </div>
                        `;
                    });
                    
                    html += `
                            </div>
                        </div>
                    `;
                }
                
                // Minutes
                if (bodyData.minutes?.length > 0) {
                    html += `
                        <div>
                            <h3 class="text-lg font-medium text-gray-900 mb-4 flex items-center">
                                <i class="fas fa-file-alt mr-2 text-blue-600"></i>
                                Recent Meetings
                            </h3>
                            <div class="space-y-4">
                    `;
                    
                    bodyData.minutes.forEach(minutes => {
                        html += `
                            <div class="border border-gray-200 rounded-lg p-4 border-l-4 border-l-blue-500">
                                <div class="flex items-start justify-between mb-2">
                                    <h4 class="font-medium text-gray-900">${minutes.title}</h4>
                                    <span class="ml-2 px-2 py-1 text-xs rounded-full ${minutes.ai_generated ? 'bg-blue-100 text-blue-800' : 'bg-gray-100 text-gray-800'}">
                                        ${minutes.ai_generated ? 'AI Summary' : 'Auto Summary'}
                                    </span>
                                </div>
                                <p class="text-sm text-gray-600 mb-3 flex items-center">
                                    <i class="fas fa-calendar mr-1"></i>
                                    ${formatDate(minutes.date)}
                                </p>
                                <p class="text-gray-700 leading-relaxed mb-3">${minutes.summary}</p>
                                ${minutes.url ? `
                                    <div class="pt-2 border-t border-gray-100">
                                        <a href="${minutes.url}" target="_blank" rel="noopener noreferrer" 
                                           class="inline-flex items-center text-sm text-blue-600 hover:text-blue-800 transition-colors">
                                            <i class="fas fa-external-link-alt mr-1"></i>
                                            View Full Meeting Minutes
                                        </a>
                                    </div>
                                ` : ''}
                            </div>
                        `;
                    });
                    
                    html += `
                            </div>
                        </div>
                    `;
                }
                
                html += `
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        function loadData() {
            // In production, this would fetch from /api/summaries
            // For now, use mock data
            setTimeout(() => {
                allData = mockData;
                filteredData = allData;
                
                updateStats(allData);
                populateBodyFilter(allData);
                renderResults(filteredData);
                
                document.getElementById('last-updated').textContent = `Last updated: ${new Date().toLocaleString()}`;
                
                // Hide loading, show content
                document.getElementById('loading').classList.add('hidden');
                document.getElementById('main-content').classList.remove('hidden');
            }, 1000);
        }

        function refreshData() {
            document.getElementById('loading').classList.remove('hidden');
            document.getElementById('main-content').classList.add('hidden');
            loadData();
        }

        // Initialize the page
        document.addEventListener('DOMContentLoaded', loadData);
    </script>
</body>
</html>

